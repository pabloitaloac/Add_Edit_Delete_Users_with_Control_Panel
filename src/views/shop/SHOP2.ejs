<html lang="pt-br">
  <%- include('../partials/head.ejs') %>
  <header>
    <%- include('../partials/shop/navbarShop.ejs') %>
    <%- include('../partials/AddUser.ejs') %>
  </header>

  <body>
    <div>Este é um exemplo de loja</div>

    <br />
    
<a class="allContents" id="allContents">

    <div class="showProducts" id="showProducts">
    

      
      
      
      
      
      
            
  

<%  if(allProducts.length > 0) { allProducts.forEach( product => {     %>

  
  
  
  
  
  

  
  <!-- <li > -->
    <form id="singleProduct">
      <!-- <a href=""> -->
        <img
        id="image"
        class="imageProduct"
        src="<%=product.productImage%>"
        />
        
        
        <p class="name"  id="<%=product.productName%>-name"><%=product.productName%></p>
        
        
        <p class="situation">disponíveis: &nbsp</p>                
        <p class="situation" id="<%=product.productName%>-situation"><%=product.productQtd%></p>
    
                <br>
                
                <p class="preCost">Preço: &nbsp</p>
                <p class="rs">R$</p><p class="cost" id="<%=product.productName%>-cost"><%=product.productNormalPrice.toFixed(2)%></p>
                
                
                
                
                <p class="prePromo">Clube Fidelidade: &nbsp</p>
                <p class="rs">R$</p><p class="promo" id="<%=product.productName%>-promo"><%=product.productSpecialPrice.toFixed(2)%></p>
                
                <br>
                
                
                
                <p id="promo"></p>
                
                <br>
                
                
                <label class="txtQtdProduct" for="qtdProduct">Quantidade:</label>
                <input type="number" class="qtdProduct" name="qtdProduct" id="qtdProduct" value="1">
                
                <br><br>
                
                <button type="button" id="<%=product.productName%>" 
                onclick="addToCart(id, qtdProduct)">                  
                Adicionar ao carrinho
              </button>
              <!-- </a> -->
            </form>
            <!-- </li> -->
            
            
<%  })  } %>
            
            <p>
              <select name="pageSelector" id="pageSelector">
                <option value="1">1</option>
              </select>
            </p>
          </div>
          
          
          
          <b class="cartInPage" id="cartInPage">
            
            <h3 class="nameCart">Carrinho: <hr><br></h3>
            <p class="cartToChange" id="cartToChange">        
            </p>
            <br><hr>
            <p class="totalToChange" id="totalToChange">
              
              TOTAL: R$0.00
            </p>
            
          </b>          
          
        </a>
        
      </body>
      
      <footer><%- include('../partials/foot.ejs') %></footer>
      
  <style>

    .allContents{                
        
        text-align: center;
        
        padding: 10px;

    }
    

    .cartInPage{
      max-width: 350px;
      height: 50px;
      padding: 10px;

      
      border-radius: 5px;
      
      text-align: center;
      align-items: center;
      align-content: center;
      
      
      display: inline-table;

      background-color: rgb(255, 255, 255);

      margin-left: 50px;  
      margin-top: 0px;

      
      border-radius: 5px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);

      margin-bottom: 0pt;
      padding-bottom: 0pt;
    }

.infoCartPromo{
  color: rgb(0, 214, 0);
}

.totalToChange{
      color: rgb(0, 0, 0);

      font-size: 14pt;
      font-weight: bold;

  }
    
    
    
    .showProducts {
      width: 900px;
      
      height: auto;    
      padding: 10px;


      text-align: center;
      align-items: center;
      align-content: center;
      
      display: inline-table;

    }

    #singleProduct {
      width: 200px;
      height: 250px;
      

      border: 1px;
      border-radius: 3%;
      border-style: solid;

      padding: 5px;
      display: inline-table;
      margin: 5px;

      text-align: center;
      align-items: center;
      align-content: center;
      


}
.qtdProduct{
  width: 30pt;
  text-align: center;
  
}
    .imageProduct {
      width: 100px;
      height: 100px;        
    }


    .preName, .name{
      color: rgb(0, 0, 0);
      font-size: 14pt;            
      font-weight: bold;
      text-transform: uppercase;
      line-height: 30pt;

    }

      .cost{
      color: rgb(255, 255, 255);
      background-color: rgb(116, 116, 255);

      font-size: 12pt;      
      font-weight: bold;

      max-height: 60px;
      width: fit-content;

      display: inline-table;

      border-radius: 10pt;
      padding: 5px;
      padding-top: 0px;
      padding-bottom: 0%;



    }

    .preCost,.prePromo,.rs{
      display: inline-table;
      font-size: 10pt;      
      font-weight: bold;

    }
    .promo{    
      color: rgb(255, 255, 255);
      background-color: rgb(0, 184, 0);
      font-size: 12pt;      
      font-weight: bold;

      max-height: 60px;
      width: fit-content;

      display: inline-table;

      border-radius: 10pt;
      padding: 5px;
      padding-top: 0px;
      padding-bottom: 0%;
  
    }

    .situation{
      font-size: 08pt;
      display: inline-table;

    }


  </style>


<script>

//guardando valor carrinho
var totalCart = []
var qtdCart = []

function addToCart(thisProduct, qtdProduct){

    var q = qtdProduct.value

      var n = thisProduct
      var im = document.getElementById(thisProduct+'-image')
      var s = document.getElementById(thisProduct+'-situation').textContent


      var c = ((document.getElementById(thisProduct+'-cost').textContent)*q).toFixed(2)
          var cToNumber = parseFloat(c)

      var p = ((document.getElementById(thisProduct+'-promo').textContent)*q).toFixed(2)
        if(p.length<=0){
          var p = null
        }
        else{
          var c = p
          var isPromo = true

          var cToNumber = parseFloat(c)
        }

        //calculing - var sum == total
        totalCart.push(cToNumber)
        
                var sum = 0.00;

                for(var i =0;i<totalCart.length;i++){
                  sum+=totalCart[i];
                }

        qtdCart.push(parseFloat(q))

                var qtdSum = 0

                for(var i = 0 ; i<qtdCart.length ; i++){
                  qtdSum+=qtdCart[i]
                }
                


      //adding to cart

        
      
        var createPImage = document.createElement("a")
                  createPImage.className = 'infoCart'
        var createPNome = document.createElement("a")
                  createPNome.className = 'infoCart'

        var createPCost = document.createElement("a")
                  createPCost.className = 'infoCart'

                if(isPromo == true){
                  var createInfoPromo = document.createElement("a")
                            createInfoPromo.className = 'infoCartPromo'

                  createInfoPromo.innerHTML = `CLUBE!   &nbsp&nbsp&nbsp`
                }
                


        createPNome.innerHTML = `| ${q} X ${n} = `
        createPCost.innerHTML = `R$${c}<br>`
        document.getElementById('totalToChange').innerHTML = `Itens: ${qtdSum} | TOTAL: R$${sum.toFixed(2)}`
        
        if(isPromo == true){
          document.getElementById('cartToChange').append(createInfoPromo)  
        }
        
        document.getElementById('cartToChange').append(createPNome)        
        document.getElementById('cartToChange').append(createPCost)
        

        //att total (02 decimals)
      
}


</script>



</html>
