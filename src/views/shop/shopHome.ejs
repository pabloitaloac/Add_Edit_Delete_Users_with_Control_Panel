<html lang="pt-br">
  <%- include('../partials/head.ejs') %>
  <header>
    <%- include('../partials/shop/navbarShop.ejs') %>
    <%- include('../partials/AddUser.ejs') %>
  </header>

  <body>
    <div>Este é um exemplo de loja</div>

    <br />
    
<a class="allContents" id="allContents">

    <div class="showProducts" id="showProducts">
    

  
<%  var myArray = Object.values(allProducts)  %>



<% if(myArray.length>0){    %>
  
      <%  for ( i=0 ; i<myArray.length  ; i++ ) { %>  



        <!-- <li > -->
          <form id="singleProduct">
              <!-- <a href=""> -->
                <img
                  id="<%=myArray[i].nome%>-image"
                  class="imageProduct"
                  src="<%= myArray[i].img%>        
                  "
                />
    

                <p class="name"  id="name"><%=myArray[i].nome%></p>
    

                <p class="situation">disponíveis: &nbsp</p>                
                <p class="situation" id="<%=myArray[i].nome%>-situation"><%= myArray[i].qtd%></p>
    
                <br>

                <p class="preCost">Preço: &nbsp</p>
                <p class="rs">R$</p><p class="cost" id="<%=myArray[i].nome%>-cost"><%=myArray[i].precoRegular%></p>
    

                  <%  if(myArray[i].precoPromocao != null){%>

                    <p class="prePromo">Clube Fidelidade: &nbsp</p>
                    <p class="rs">R$</p><p class="promo" id="<%=myArray[i].nome%>-promo"><%=myArray[i].precoPromocao%></p>
                
                    <br>

                  <% } else {%>
                  
                     <p id="<%=myArray[i].nome%>-promo"></p>
                  
                     <br>
                   <%  }%>
                
                <label class="txtQtdProduct" for="qtdProduct">Quantidade:</label>
                <input type="number" class="qtdProduct" id="qtdProduct">
                
                <br><br>

                <button type="button" id="<%=myArray[i].nome%>" 
                  onclick="addToCart(id)">                  
                  Adicionar ao carrinho
                </button>
              <!-- </a> -->
          </form>
        <!-- </li> -->
  

<%  }}   %>     

        <p>
          <select name="pageSelector" id="pageSelector">
              <option value="1">1</option>
          </select>
        </p>
</div>



  <b class="cartInPage" id="cartInPage">

    <h3 class="nameCart">Carrinho: <hr><br></h3>
      <p class="cartToChange" id="cartToChange">        
      </p>
      <br><hr>
      <p class="totalToChange" id="totalToChange">
                
        TOTAL: R$0.00
      </p>

  </b>          

</a>

</body>

  <footer><%- include('../partials/foot.ejs') %></footer>

  <style>

    .allContents{                
        
        text-align: center;
        
        padding: 10px;

    }
    

    .cartInPage{
      max-width: 350px;
      height: 50px;
      padding: 10px;

      
      border-radius: 5px;
      
      text-align: center;
      align-items: center;
      align-content: center;
      
      
      display: inline-table;

      background-color: rgb(255, 255, 255);

      margin-left: 50px;  
      margin-top: 0px;

      
      border-radius: 5px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);

      margin-bottom: 0pt;
      padding-bottom: 0pt;
    }

.infoCartPromo{
  color: rgb(0, 214, 0);
}

.totalToChange{
      color: rgb(0, 0, 0);

      font-size: 14pt;
      font-weight: bold;

  }
    
    
    
    .showProducts {
      width: 900px;
      
      height: auto;    
      padding: 10px;


      text-align: center;
      align-items: center;
      align-content: center;
      
      display: inline-table;

    }

    #singleProduct {
      width: 200px;
      height: 250px;
      

      border: 1px;
      border-radius: 3%;
      border-style: solid;

      padding: 5px;
      display: inline-table;
      margin: 5px;

      text-align: center;
      align-items: center;
      align-content: center;
      


}
.qtdProduct{
  width: 30pt;
  text-align: center;
  
}
    .imageProduct {
      width: 100px;
      height: 100px;        
    }


    .preName, .name{
      color: rgb(0, 0, 0);
      font-size: 14pt;            
      font-weight: bold;
      text-transform: uppercase;
      line-height: 30pt;

    }

      .cost{
      color: rgb(255, 255, 255);
      background-color: rgb(116, 116, 255);

      font-size: 12pt;      
      font-weight: bold;

      max-height: 60px;
      width: fit-content;

      display: inline-table;

      border-radius: 10pt;
      padding: 5px;
      padding-top: 0px;
      padding-bottom: 0%;



    }

    .preCost,.prePromo,.rs{
      display: inline-table;
      font-size: 10pt;      
      font-weight: bold;

    }
    .promo{    
      color: rgb(255, 255, 255);
      background-color: rgb(0, 184, 0);
      font-size: 12pt;      
      font-weight: bold;

      max-height: 60px;
      width: fit-content;

      display: inline-table;

      border-radius: 10pt;
      padding: 5px;
      padding-top: 0px;
      padding-bottom: 0%;
  
    }

    .situation{
      font-size: 08pt;
      display: inline-table;

    }


  </style>


<script>

//guardando valor carrinho
var totalCart = []

function addToCart(thisProduct){

    var n = thisProduct
    var im = document.getElementById(thisProduct+'-image')
    var s = document.getElementById(thisProduct+'-situation').textContent
    var c = document.getElementById(thisProduct+'-cost').textContent
        var cToNumber = parseFloat(c)
    var p = document.getElementById(thisProduct+'-promo').textContent
      if(p.length<=0){
        var p = null
      }
      else{
        var c = p
        var isPromo = true

        var cToNumber = parseFloat(c)
      }

      //calculing - var sum == total
      totalCart.push(cToNumber)
      
              var sum = 0.00;

              for(var i =0;i<totalCart.length;i++){
                sum+=totalCart[i];
              }

              


    //adding to cart

      // var product = document.createTextNode(`${n} `)
      

      
      
        // `${n} , Disponibilidade: ${s}, Valor: R$${c}, Promoção: R$${p}`
    
      var createPImage = document.createElement("a")
                createPImage.className = 'infoCart'
      var createPNome = document.createElement("a")
                createPNome.className = 'infoCart'

      var createPCost = document.createElement("a")
                createPCost.className = 'infoCart'

              if(isPromo == true){
                var createInfoPromo = document.createElement("a")
                          createInfoPromo.className = 'infoCartPromo'

                createInfoPromo.innerHTML = `CLUBE!   &nbsp&nbsp&nbsp`
              }
              


      createPNome.innerHTML = `${n} | `
      createPCost.innerHTML = `R$${c}<br>`
      document.getElementById('totalToChange').innerHTML = `TOTAL: R$${sum.toFixed(2)}`
      
      if(isPromo == true){
        document.getElementById('cartToChange').append(createInfoPromo)  
      }
      
      document.getElementById('cartToChange').append(createPNome)        
      document.getElementById('cartToChange').append(createPCost)
      

      //att total (02 decimals)
      
}


</script>



</html>
